<script src="{{ 'country-province-selector.js' | asset_url }}" defer></script>
<script src="{{ 'customer-addresses.js' | asset_url }}" defer></script>

{% paginate customer.addresses by 10 %}
<div class="container fully-spaced-row--small account-page account-addresses-page" style="--page-container-width: {{ settings.max_page_width | at_most: 1200 }}px;">
  <customer-addresses>
    <div class="account-header" {%- render 'animation-attrs', attrs: 'data-cc-animate' -%}>
      <div class="account-header__text">
        <a class="account-header__back note underline" href="{{ routes.account_url }}">{{ 'customer.account.home' | t }}</a>
        <h2 class="account-header__title title">{{ 'customer.addresses.title' | t }}</h2>
      </div>
      <button class="btn btn--secondary js-add-address">{{ 'customer.addresses.add_new' | t }}</button>
    </div>

    <div id="add_address" class="customer_address account-form edit_address small-form hidden">
      {% form 'customer_address', customer.new_address %}
        <h4>{{ 'customer.addresses.add_new' | t }}</h4>

        <div class="input-row">
          <label for="address_first_name_new">{{ 'customer.addresses.first_name' | t }}</label>
          <input type="text" id="address_first_name_new" class="address_form" name="address[first_name]" value="{{ form.first_name }}" size="40" />
        </div>
        <div class="input-row">
          <label for="address_last_name_new">{{ 'customer.addresses.last_name' | t }}</label>
          <input type="text" id="address_last_name_new" class="address_form" name="address[last_name]" value="{{ form.last_name }}" size="40" />
        </div>
        <div class="input-row">
          <label for="address_company_new">{{ 'customer.addresses.company' | t }}</label>
          <input type="text" id="address_company_new" class="address_form" name="address[company]" value="{{ form.company }}" size="40" />
        </div>
        <div class="input-row">
          <label for="address_address1_new">{{ 'customer.addresses.address1' | t }}</label>
          <input type="text" id="address_address1_new" class="address_form" name="address[address1]" value="{{ form.address1 }}" size="40" />
        </div>
        <div class="input-row">
          <label for="address_address2_new">{{ 'customer.addresses.address2' | t }}</label>
          <input type="text" id="address_address2_new" class="address_form" name="address[address2]" value="{{ form.address2 }}" size="40" />
        </div>
        <div class="input-row">
          <label for="address_city_new">{{ 'customer.addresses.city' | t }}</label>
          <input type="text" id="address_city_new" class="address_form" name="address[city]" value="{{ form.city }}" size="40" />
        </div>

        <country-province-selector>
          <div class="input-row">
            <label for="edit-new-country">{{ 'customer.addresses.country' | t }}</label>
            <span class="lightly-styled-select">
              <select class="w-full js-country-select" id="edit-new-country" name="address[country]" data-default="{{ form.country }}" autocomplete="country">
                {{ all_country_option_tags }}
              </select>
              {% render 'icon-chevron-down' %}
            </span>
          </div>
          <div class="input-row js-province-container" id="edit-new-province-container" hidden>
            <label for="edit-new-province">{{ 'customer.addresses.province' | t }}</label>
            <span class="lightly-styled-select">
              <select class="w-full js-province-select" id="edit-new-province" name="address[province]" data-default="{{ form.province }}" autocomplete="address-level1">
              </select>
              {% render 'icon-chevron-down' %}
            </span>
          </div>
        </country-province-selector>

        <div class="input-row">
          <label for="address_zip_new">{{ 'customer.addresses.zip' | t }}</label>
          <input type="text" id="address_zip_new" class="address_form" name="address[zip]" value="{{ form.zip }}" size="40" />
        </div>
        <div class="input-row">
          <label for="address_phone_new">{{ 'customer.addresses.phone' | t }}</label>
          <input type="tel" id="address_phone_new" class="address_form" name="address[phone]" value="{{ form.phone }}" size="40" />
        </div>
        <div class="input-row">
          <label class="checkbox-label">
            {{ form.set_as_default_checkbox }} {{ 'customer.addresses.set_default' | t }}
          </label>
        </div>
        <div class="lightly-spaced-row-above">
          <p>
            <button class="btn" type="submit">{{ 'customer.addresses.add' | t }}</button>
          </p>
          <span class="note"><a href="#" class="js-cancel underline">{{ 'customer.addresses.cancel' | t }}</a></span>
        </div>
      {% endform %}
    </div>

    <div class="address-tables" {%- render 'animation-attrs', attrs: 'data-cc-animate' -%}>
      {% for address in customer.addresses %}
      <div class="info-card spaced-row address-card">
        <div id="view_address_{{ address.id }}" class="customer_address">
          <h4 class="address_title">
            {{ address.street }}
            {% if address == customer.default_address %}<span class="note">({{ 'customer.addresses.default' | t }})</span>{% endif %}
          </h4>
          <div class="view_address lightly-spaced-row">
            <div>{{ address.first_name }} {{ address.last_name }}</div>
            <div>{{ address.company }}</div>
            <div>{{ address.street }}</div>
            <div>{{ address.city }} {% if address.province %}, {{ address.province }}{% endif %}</div>
            <div>{{ address.country }} {{ address.zip }}</div>
            <div class="address-phone">{{ address.phone }}</div>
          </div>
          <p class="address-actions">
            <a href="#"
              class="address-edit-toggle js-edit-address underline"
              data-form-id="{{ address.id }}"
              aria-owns="edit_address_{{ address.id }}"
              aria-expanded="false"
            >
              {{- 'customer.addresses.edit' | t -}}
            </a>
            <a href="#"
              class="address-delete js-delete-address underline"
              data-target="{{ address.url }}"
              data-confirm-message="{{ 'customer.addresses.delete_confirm' | t }}"
            >
              {{- 'customer.addresses.delete' | t -}}
            </a>
          </p>
        </div>
        <div id="edit_address_{{ address.id }}" class="customer_address account-form edit_address small-form hidden">
          <h4>{{ 'customer.addresses.edit_address' | t }}</h4>

          {% form 'customer_address', address %}

              <div class="input-row">
                <label for="address_first_name_{{ form.id }}">{{ 'customer.addresses.first_name' | t }}</label>
                <input type="text" id="address_first_name_{{ form.id }}" class="address_form" name="address[first_name]" value="{{ form.first_name }}" size="40" />
              </div>
              <div class="input-row">
                <label for="address_last_name_{{ form.id }}">{{ 'customer.addresses.last_name' | t }}</label>
                <input type="text" id="address_last_name_{{ form.id }}" class="address_form" name="address[last_name]" value="{{ form.last_name }}" size="40" />
              </div>
              <div class="input-row">
                <label for="address_company_{{ form.id }}">{{ 'customer.addresses.company' | t }}</label>
                <input type="text" id="address_company_{{ form.id }}" class="address_form" name="address[company]" value="{{ form.company }}" size="40" />
              </div>
              <div class="input-row">
                <label for="address_address1_{{ form.id }}">{{ 'customer.addresses.address1' | t }}</label>
                <input type="text" id="address_address1_{{ form.id }}" class="address_form" name="address[address1]" value="{{ form.address1 }}" size="40" />
              </div>
              <div class="input-row">
                <label for="address_address2_{{ form.id }}">{{ 'customer.addresses.address2' | t }}</label>
                <input type="text" id="address_address2_{{ form.id }}" class="address_form" name="address[address2]" value="{{ form.address2 }}" size="40" />
              </div>
              <div class="input-row">
                <label for="address_city_{{ form.id }}">{{ 'customer.addresses.city' | t }}</label>
                <input type="text" id="address_city_{{ form.id }}" class="address_form" name="address[city]" value="{{ form.city }}" size="40" />
              </div>

              <country-province-selector>
                <div class="input-row">
                  <label for="edit-{{ address.id }}-country">{{ 'customer.addresses.country' | t }}</label>
                  <span class="lightly-styled-select">
                    <select class="w-full js-country-select" id="edit-{{ address.id }}-country" name="address[country]" data-default="{{ form.country }}" autocomplete="country">
                      {{ all_country_option_tags }}
                    </select>
                    {% render 'icon-chevron-down' %}
                  </span>
                </div>
                <div class="input-row js-province-container" id="edit-{{ address.id }}-province-container" hidden>
                  <label for="edit-{{ address.id }}-province">{{ 'customer.addresses.province' | t }}</label>
                  <span class="lightly-styled-select">
                    <select class="w-full js-province-select" id="edit-{{ address.id }}-province" name="address[province]" data-default="{{ form.province }}" autocomplete="address-level1">
                    </select>
                    {% render 'icon-chevron-down' %}
                  </span>
                </div>
              </country-province-selector>

              <div class="input-row">
                <label for="address_zip_{{ form.id }}">{{ 'customer.addresses.zip' | t }}</label>
                <input type="text" id="address_zip_{{ form.id }}" class="address_form" name="address[zip]" value="{{ form.zip }}" size="40" />
              </div>
              <div class="input-row">
                <label for="address_phone_{{ form.id }}">{{ 'customer.addresses.phone' | t }}</label>
                <input type="tel" id="address_phone_{{ form.id }}" class="address_form" name="address[phone]" value="{{ form.phone }}" size="40" />
              </div>
              <div class="input-row">
                <label class="checkbox-label">
                  {{ form.set_as_default_checkbox }} {{ 'customer.addresses.set_default' | t }}
                </label>
              </div>
            <div class="lightly-spaced-row-above">
              <p><button class="btn" type="submit">{{ 'customer.addresses.update' | t }}</button></p>
              <p><span class="note"><a href="#" class="js-cancel underline">{{ 'customer.addresses.cancel' | t }}</a></span></p>
            </div>
          {% endform %}
        </div>
      </div>
      {% endfor %}

    </div>
  </customer-addresses>

  <div class="pagination-row">{% render 'pagination-control', paginate: paginate %}</div>
</div>
{% endpaginate %}

<style>
  #shopify-section-{{ section.id }} .account-addresses-page {
    max-width: var(--page-container-width, 1200px);
    margin-inline: auto;
  }

  #shopify-section-{{ section.id }} .account-header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 32px;
    padding-bottom: 24px;
    border-bottom: 1px solid rgb(var(--text-color) / var(--divider-opacity));
    margin-bottom: 28px;
  }

  #shopify-section-{{ section.id }} .account-header__text {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  #shopify-section-{{ section.id }} .account-header__back {
    font-size: 13px;
  }

  #shopify-section-{{ section.id }} .account-header__title {
    margin: 0;
    text-align: left;
    font-size: clamp(22px, 2.2vw, 28px);
    font-weight: 600;
  }

  #shopify-section-{{ section.id }} .address-tables {
    margin-top: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
  }

  #shopify-section-{{ section.id }} .address-card {
    background: rgb(var(--body-bg-color));
    border-radius: 12px;
    padding: 18px 20px 20px;
    border: 1px solid rgb(var(--text-color) / 0.06);
    box-shadow: 0 10px 28px rgba(15, 23, 42, 0.04);
  }

  #shopify-section-{{ section.id }} .address_title {
    margin: 0 0 10px;
    font-size: 15px;
    font-weight: 600;
  }

  #shopify-section-{{ section.id }} .address_title .note {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-left: 6px;
    color: rgb(var(--text-2));
  }

  #shopify-section-{{ section.id }} .view_address div {
    line-height: 1.6;
    font-size: 14px;
  }

  #shopify-section-{{ section.id }} .view_address div + div {
    margin-top: 2px;
  }

  #shopify-section-{{ section.id }} .address-actions {
    margin-top: 14px;
    font-size: 13px;
  }

  #shopify-section-{{ section.id }} .address-actions a {
    margin-right: 12px;
    text-underline-offset: 3px;
    text-decoration-thickness: 1px;
  }

  #shopify-section-{{ section.id }} .customer_address.account-form.edit_address.small-form,
  #shopify-section-{{ section.id }} #add_address.customer_address.account-form.edit_address.small-form {
    max-width: 520px;
    margin-top: 22px;
    padding: 20px 22px 24px;
    border-radius: 12px;
    border: 1px solid rgb(var(--text-color) / 0.06);
    box-shadow: 0 10px 28px rgba(15, 23, 42, 0.04);
    background: rgb(var(--body-bg-color));
  }

  #shopify-section-{{ section.id }} .customer_address.account-form .input-row {
    margin-bottom: 18px;
  }

  #shopify-section-{{ section.id }} .customer_address.account-form .input-row label {
    font-size: 14px;
    font-weight: 500;
  }

  #shopify-section-{{ section.id }} .customer_address.account-form .address_form {
    width: 100%;
  }

  #shopify-section-{{ section.id }} .pagination-row {
    margin-top: 24px;
  }

  @media (max-width: 767.98px) {
    #shopify-section-{{ section.id }} .account-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 14px;
    }

    #shopify-section-{{ section.id }} .account-header__title {
      font-size: 22px;
    }
  }
</style>
