<div class="fully-spaced-row container">
  <div class="account-form{% if shop.checkout.guest_login %} flexible-layout{% endif %}" {%- render 'animation-attrs', attrs: 'data-cc-animate' -%}>
    <div class="{% if shop.checkout.guest_login %}column column--half{% else %}small-form{% endif %}">
      <div id="customer">
        <div class="page-header{% if shop.checkout.guest_login %} align-start{% endif %}">
          <h2 class="title">{{ 'customer.login.title' | t }}</h2>
          {%- liquid
            assign lang = request.locale.iso_code
            case lang
              when 'de'
                assign login_note = 'Melden Sie sich an, um Bestellungen und Prämien zu verwalten.'
              when 'fr'
                assign login_note = 'Connectez-vous pour gérer vos commandes et vos récompenses.'
              when 'fi'
                assign login_note = 'Kirjaudu sisään hallitaksesi tilauksia ja palkintoja.'
              else
                assign login_note = 'Sign in to manage orders and rewards.'
            endcase
          -%}
          <p class="note">{{ login_note }}</p>
        </div>

        {%- if section.settings.enable_shop_login_button -%}
          <div class="text-center">
            {{- shop | login_button -}}
    
            <p class="mt-4 mb-4">
              {{ 'customer.login.alternate_provider_separator' | t }}
            </p>
          </div>
        {%- endif -%}

        <div class="auth-card">
        {% form 'customer_login' %}

        {%- render 'form-errors', form: form -%}

        <div id="login_email" class="input-row">
          <label for="customer_email" class="login">{{ 'customer.login.email' | t }}</label>
          <div class="input-with-icon">
            <span class="input-icon-left">{% render 'icon', icon: 'mail', size: 'small' %}</span>
            <input type="email" value="" name="customer[email]" id="customer_email" class="large" size="30" />
          </div>
        </div>

        {% if form.password_needed %}

        {% comment %}
        Customer Account Login
        {% endcomment %}

        <div id="login_password" class="input-row">
          <label for="customer_password" class="login">{{ 'customer.login.password' | t }}</label>
          <div class="text-over-input">
            <span class="input-icon-left">{% render 'icon', icon: 'lock', size: 'small' %}</span>
            <input type="password" value="" name="customer[password]" id="customer_password" class="large password" size="16" />
            <button type="button" class="password-toggle" data-target="customer_password" aria-pressed="true" aria-label="Show password">{% render 'icon', icon: 'eye', size: 'small' %}</button>
            <div id="forgot_password" class="text-over-input__text">
              <a class="underline" href="#" onclick="showRecoverPasswordForm();return false;">{{ 'customer.login.forgot_password' | t }}</a>
            </div>
          </div>
        </div>

        {% endif %}

        <div class="lightly-spaced-row-above">
          <button class="btn" type="submit">{{ 'customer.login.sign_in' | t }}</button>
        </div>
        <div class="lightly-spaced-row create-account-link">
          <a href="{{ routes.account_register_url }}" class="btn btn--tertiary" role="button">{{ 'customer.register.title' | t }}</a>
        </div>
        {% endform %}
        </div>
      </div>

      {% comment %}
      Recover Password Form
      {% endcomment %}

      <div id="recover-password" style='display:none'>
        <div class="auth-card">
        {% form 'recover_customer_password' %}
        {% if form.posted_successfully? %}
        {% assign reset_success = true %}
        {% endif %}
        <div class="page-header">
          <h2 class="title">{{ 'customer.recover_password.title' | t }}</h2>
          {% unless reset_success %}
          <p class="note">{{ 'customer.recover_password.subtext' | t }}</p>
          {% endunless %}
        </div>

        {%- render 'form-errors', form: form -%}

        {% if reset_success %}

        <div class="lightly-spaced-row-above">
          <p>{{ 'customer.recover_password.success' | t }}</p>
          <span class="note"><a class="underline" href="#" onclick="hideRecoverPasswordForm();return false;">{{ 'customer.login.sign_in' | t }}</a></span>
        </div>

        {% else %}

        <div id="recover_email" class="input-row">
          <label for="recover-email" class="large">{{ 'customer.recover_password.email' | t }}</label>
          <input type="email" value="" size="30" name="email" id="recover-email" class="large" />
        </div>
        <div class="lightly-spaced-row-above">
          <button class="btn" type="submit">{{ 'customer.recover_password.submit' | t }}</button>
        </div>
        <div class="lightly-spaced-row">
          <button class="btn btn--tertiary cancel-btn" type="button" onclick="hideRecoverPasswordForm();return false;">{{ 'customer.recover_password.cancel' | t }}</button>
        </div>

        {% endif %}

        {% endform %}
        </div>
      </div>
    </div><!-- /layout-column-half-left" -->

    {% comment %}
    Guest Login form for shops with optional customer accounts. This form is displayed only when users click on the checkout link
    on the cart page.
    {% endcomment %}

    {% if shop.checkout.guest_login %}
    <div id="guest" class="column column--half">
      <div class="page-header align-start">
        <h3 class="title">{{ 'customer.login.guest_title' | t }}</h3>
      </div>
      {% form 'guest_login' %}
        <button class="btn" type="submit">{{ 'customer.login.guest_continue' | t }}</button>
      {% endform %}
    </div>
    {% endif %}
  </div>
</div>

<style>
#shopify-section-{{ section.id }} .page-header .title { margin-bottom: 8px; }
#shopify-section-{{ section.id }} .page-header .note { color: rgb(var(--text-2)); }
#shopify-section-{{ section.id }} .auth-card { max-width: 520px; margin: 0 auto; padding: 24px; border: 1px solid rgba(0,0,0,0.06); border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.06); background: rgb(var(--body-bg-color)); }
#shopify-section-{{ section.id }} .auth-card .input-row { margin-bottom: 14px; }
#shopify-section-{{ section.id }} .auth-card .input-row label.login { font-weight: 600; }
#shopify-section-{{ section.id }} .auth-card input.large { width: 100%; border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px 12px; transition: border-color .2s ease, box-shadow .2s ease; }
#shopify-section-{{ section.id }} .auth-card input.large:focus { outline: 0; border-color: rgb(var(--link-color)); box-shadow: 0 0 0 4px rgba(var(--link-color) / 0.18); }
#shopify-section-{{ section.id }} .auth-card .btn { width: 100%; }
#shopify-section-{{ section.id }} .auth-card .input-with-icon { position: relative; }
#shopify-section-{{ section.id }} .auth-card .input-with-icon input.large { padding-left: 42px; }
#shopify-section-{{ section.id }} .auth-card .input-icon-left { position: absolute; top: 50%; left: 14px; transform: translateY(-50%); color: #6b7280; }
#shopify-section-{{ section.id }} .input-icon-left .icon, #shopify-section-{{ section.id }} .input-icon-left .icon * { fill: currentColor !important; stroke: none !important; }
#shopify-section-{{ section.id }} .auth-card input.password { padding-right: 42px; }
#shopify-section-{{ section.id }} .auth-card .password-toggle { position: absolute; top: 50%; right: 14px; transform: translateY(-50%); width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; color: #6b7280; }
#shopify-section-{{ section.id }} .auth-card .password-toggle[aria-pressed="true"]::after { content: ""; position: absolute; width: 20px; border-top: 2px solid currentColor; transform: rotate(-45deg); }
#shopify-section-{{ section.id }} .text-over-input input.large { padding-left: 42px; }
#shopify-section-{{ section.id }} .text-over-input__text { right: 54px; }
#shopify-section-{{ section.id }} .auth-card .cancel-btn { margin-top: 12px; }
#shopify-section-{{ section.id }} .auth-card label.login { display: inline; white-space: normal; }
#shopify-section-{{ section.id }} .auth-card label.login input[type="checkbox"] { margin-right: 8px; margin-top: 2px; }
#shopify-section-{{ section.id }} .auth-card .opposing-items { align-items: center; }
#shopify-section-{{ section.id }} .auth-card .create-account-link { margin-top: 12px; }
@media (max-width: 767.98px) { #shopify-section-{{ section.id }} .auth-card { padding: 18px; border-radius: 10px; } }
</style>
<script type="text/javascript">
  function showRecoverPasswordForm() {
    document.getElementById('recover-password').style.display = 'block';
    document.getElementById('customer').style.display='none';
  }

  function hideRecoverPasswordForm() {
    document.getElementById('recover-password').style.display = 'none';
    document.getElementById('customer').style.display = 'block';
  }

  {% if reset_success %}showRecoverPasswordForm();{% endif %}
  if (window.location.hash == '#recover') { showRecoverPasswordForm() }
  document.addEventListener('DOMContentLoaded', function(){
    var input = document.getElementById('customer_password');
    var btn = input ? input.parentNode.querySelector('.password-toggle[data-target="customer_password"]') : null;
    if (!input || !btn) return;
    btn.addEventListener('click', function(){
      var visible = input.type === 'text';
      input.type = visible ? 'password' : 'text';
      btn.setAttribute('aria-pressed', input.type === 'password' ? 'true' : 'false');
    });
  });
</script>

{% schema %}
{
  "name": "Customer login",
  "settings": [
    {
      "type": "header",
      "content": "Sign in with Shop settings"
    },
    {
      "type": "checkbox",
      "id": "enable_shop_login_button",
      "label": "Enable Sign in with Shop",
      "default": false
    }
  ]
}
{% endschema %}
