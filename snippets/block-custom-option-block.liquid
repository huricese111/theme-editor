{%- if block.settings.label != blank -%}
  {%- liquid
    assign custom_option_input_id = product_form_id | append: '-custom-' | append: forloop.index
    assign custom_input_name = block.settings.label | escape | prepend: 'properties[' | append: ']'
  -%}
  <div class="custom-option" {{ block.shopify_attributes }}>
    {% case block.settings.type %}
      {% when 'text' %}
        <div class="option-selector option-selector--custom">
          <label class="label" for="{{ custom_option_input_id }}">{{ block.settings.label | escape }}</label>
          <input
            class="custom-option__text-input"
            type="text"
            id="{{ custom_option_input_id }}"
            form="{{ product_form_id }}"
            name="{{ custom_input_name }}"
            {% if block.settings.text_required %}
              required
            {% endif %}
          >
        </div>

      {% when 'textarea' %}
        <div class="option-selector option-selector--custom">
          <label class="label" for="{{ custom_option_input_id }}">{{ block.settings.label | escape }}</label>
          <textarea
            class="custom-option__text-input"
            id="{{ custom_option_input_id }}"
            form="{{ product_form_id }}"
            name="{{ custom_input_name }}"
            {% if block.settings.text_required %}
              required
            {% endif -%}
          ></textarea>
        </div>

      {% when 'checkbox' %}
        <div class="option-selector option-selector--custom">
          <label class="label">
            <input
              type="hidden"
              form="{{ product_form_id }}"
              name="{{ custom_input_name }}"
              value="{{ block.settings.checkbox_unchecked_value | escape }}"
            >
            <input
              type="checkbox"
              form="{{ product_form_id }}"
              name="{{ custom_input_name }}"
              value="{{ block.settings.checkbox_checked_value | escape }}"
            >
            <span class="label__text-beside-input">{{ block.settings.label | escape }}</span>
          </label>
        </div>

      {% when 'multiple' %}
        {%- assign custom_options = block.settings.multiple_options
          | newline_to_br
          | strip_newlines
          | split: '<br />'
        -%}

        {% if block.settings.multiple_style == 'dropdown' %}
          <div class="option-selector option-selector--custom" data-selector-type="dropdown">
            <script src="{{ 'custom-select.js' | asset_url }}" defer></script>
            {% render 'custom-select',
              id: custom_option_input_id,
              label: block.settings.label,
              option_values: custom_options,
              selected_value: custom_options.first,
              include_native: true,
              native_name: custom_input_name,
              native_form_id: product_form_id
            %}
          </div>

        {% else %}
          <div class="option-selector option-selector--custom" data-selector-type="radio">
            <fieldset>
              <legend class="label">{{ block.settings.label | escape }}</legend>
              {% for option in custom_options %}
                <label class="label">
                  <input
                    type="radio"
                    form="{{ product_form_id }}"
                    name="{{ custom_input_name }}"
                    value="{{ option | escape }}"
                    {% if forloop.first %}
                      checked
                    {% endif %}
                  >
                  <span class="label__text-beside-input">{{ option | escape }}</span>
                </label>
              {% endfor %}
            </fieldset>
          </div>
        {% endif %}
    {% endcase %}
  </div>
{%- endif -%}
